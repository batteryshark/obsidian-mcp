# 新功能测试指南

## 新增工具

本次更新添加了两个新的MCP工具：

### 1. update_note 工具
**功能**: 使用目标文本替换来更新现有笔记内容

**参数结构**:
```json
{
  "path": "note.md",
  "edits": [
    {
      "oldText": "要替换的文本",
      "newText": "新的文本内容"
    }
  ],
  "dryRun": true
}
```

**主要特性**:
- ✅ 支持多个编辑操作
- ✅ 精确文本匹配和灵活的逐行匹配
- ✅ 保留原始缩进和格式
- ✅ 支持dry-run模式预览更改
- ✅ 原子文件操作防止数据损坏
- ✅ 统一diff格式输出

**测试用例**:
1. 简单文本替换
2. 多行文本替换
3. 保留缩进的代码块更新
4. JSON格式内容更新
5. 预览模式测试

### 2. read_multiple_notes 工具
**功能**: 同时读取多个笔记的内容

**参数结构**:
```json
{
  "paths": ["note1.md", "note2.md", "note3.md"]
}
```

**主要特性**:
- ✅ 并行读取多个文件
- ✅ 优雅错误处理（单个失败不影响整体）
- ✅ 使用分隔符清晰分隔文件内容
- ✅ 支持API和文件系统双重回退

**测试用例**:
1. 读取多个存在的笔记
2. 混合存在和不存在的笔记
3. 大量文件的批量读取
4. 网络错误时的回退行为

## 安装说明

1. 确保您的Obsidian已安装Local REST API插件
2. 双击`obsidian-mcp.dxt`文件进行安装
3. 配置您的vault路径和API token
4. 重启MCP客户端

## 文件信息

- **文件名**: obsidian-mcp.dxt
- **大小**: 12,556,479 字节 (约12MB)
- **MD5**: fdc908d588e8dcd7882f2386c71d2f9b
- **版本**: 1.2.5
- **生成时间**: 2025-07-05 12:11
- **最终修复**: 
  - ✅ 创建了正确的 `node_modules/bin/` 目录结构
  - ✅ 包含可执行文件 `node_modules/bin/obsidian-mcp`
  - ✅ 更新manifest.json指向正确的entry_point
  - ✅ 完整的依赖结构

## 技术改进

- 解决了之前update_note工具的JSON格式问题
- 使用成熟的filesystem MCP方法进行文本编辑
- 添加了diff库用于生成统一差异输出
- 智能文本匹配算法支持复杂的内容替换
- 优化了TypeScript配置以支持最新的类型定义

## 兼容性

- Node.js >= 16.0.0
- Obsidian Local REST API插件
- 支持所有现有的MCP工具
- 向后兼容之前的配置